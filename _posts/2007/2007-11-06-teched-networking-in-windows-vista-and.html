---
layout: post
title: 'TechEd: Networking in Windows Vista and Windows Server 2008t'
date: '2007-11-06T13:07:00.001Z'

tags: 
modified_time: '2007-11-08T13:55:40.880Z'
blogger_id: tag:blogger.com,1999:blog-4015568221071268916.post-689302372873105954
blogger_orig_url: http://serialseb.blogspot.com/2007/11/teched-networking-in-windows-vista-and.html
---

<p>.Why do we need to discuss the new network stack? We want faster applications, we want to connect to anyone else, and we want a simpler, direct model without yet another server. For all these reasons we need the next generation TCP/IP.</p> <p>There are some issues with Vista network issue. The Multimedia Scheduler service.&nbsp; Mark Russinovitch published an article about it [EDIT: <a href="http://blogs.technet.com/markrussinovich/archive/2007/08/27/1833290.aspx">Here's the link to the article about the interaction with networking and multimedia scheduler</a>]. One <strong>hopes</strong> this will be fixed by SP1.\</p> <p>The new tcp/ip stack is a huge project for Microsoft becase it's the first-time microsoft re-write since the early 90's. It was an outdated technology. NG TCP/IP ships with Vista and a slightly different in Server 2008.</p> <p>The major improvements include receive window auto-tuning, Compound TCP for very fast LANs, ECN - a way for routers to let the client knows when it's overloaded to reroute the data, better support for lossy network - RFC <a href="http://www.ietf.org/rfc/rfc2582.txt">2582</a>, <a href="http://www.ietf.org/rfc/rfc2883.txt ">2883</a>, <a href="http://www.ietf.org/rfc/rfc3517.txt ">3517</a>, <a href="http://www.ietf.org/rfc/rfc4138.txt ">4138</a>, and some great IPv6 network with Neighbour Unreachability Detection.</p> <p>There are other benefits too:&nbsp; much simpler API, security enhancements with API filtering and monitoring, support for stack offload, and multiprocessor scalability, which was not possible before because of NDIS 5.1 limitations. </p> <p>There are also a few conveniences: there's no restart, there's auto-configuration and self-tuning of IPv4, and policy-based QoS. There's for users roaming support in IPv4 and (better) in IPv6, home network support has been simplified, and there's more efficient multicasting.</p> <p>So far, it may change in the future, but so far we have full resistance to all TCP/IP level DoS attacks, and IPv6 for more security. You also have the concept of routing compartments.</p> <p>Let me try and make you a bit enthusiastic about IPv6. We are running out of address. Don't believe me, believe these numbers. ARIN announced on 21th May 2007 that we will run out in 2010. RIPE 55 Meeting took place two weeks ago said we have 2-4 years before running out, and Mr Vint Cert said that on BBC news too.</p> <p>Theoretically, we could live without ip addresses. We could have several levels of NATs but it blocks us from performing p2p networks. NAT makes peer-to-peer very difficult, because of security. We need to find a balance. Seucirty of IPv4 doesn't exist. IPSec is optional, not so in IPv6. IPv6 provides significantly better QoS than IPv4. Routing tables will shrink with IPv6. Mobility does not work in IPv4. Finally device autoconf doesn't work so well. Some technologies has been backported, but it doesn't work very well. </p> <p>6 benefits of IPv6: Address depletion solved, ent2end p2p communication restored, mobile and roaming connectivity, international mis-allocation, autoconf.</p> <p>Terminology, we still talk about Hosts, we have LAN segments, Links, Subnets... In IPv4 a subnet is restricted to a few devices within the same network. Any enterprise network has a wardrobe of devices to solve the subnet. You don't have subnets communicating with other subnets communicating thanks to a Cisco router.</p> <p>We have 128 bits for our addresses. We usually split it with 64 bits for subnet IDs, and 64 bits for interface ID.</p> <p>IPv6 is expressed as 8 blocks of hexadecimal 16bits components. </p> <p>A great thing for IPv6 is that there are classes instead of subnet masks: The CIDR notation.</p> <p>There are 3 classes of address: Unicast, Multicast, Anycast. There are no more broadcast address. IPv4 wasn't designed for networks with very large amount of machines within the same submask. Now it's gone, you'll get a performance boost. Instad of broadcasting, there's a bunch of neighbor networking protocols.</p> <p>There's a new unspecified address, and there's a new Loopback: ::1. There's the concept of a well known address. DNS Servers are supposed to be FEC0::FFF::1 FEC0::FFFF::2 and FFEC0::FFFF::3. As a developer, be aware that you should be able to accept v6 addresses.</p> <p>Configuration can use DHCP, where the address is generated. What they don't need to perform anymore is the address generation. The other thing is that addresses expire. That gives us back some efficeincy and clears the address space.</p> <p>Addresses expire, and one of the key things in IPv6 is that you have multiple address. You have global addresses, one expired, one in the future, some local addresses have local addresses, or several link local addresses. It's the key change: in IPv4, when designed, all the processing was on routers. In IPv6 we change the balance, nodes have enough power to do some networking process. That lets us have autonomous networks, by moving.</p> <p>Mobility is the coolest thing, it's so simple and powerful it's beautiful. When a device tries to connect, it can't get any neighbors. Then it creates a local address. If the router contributes, you can change global addresses but your home address will make sure data keeps on flowing.</p> <p>VIsta has what is known as a Dual-Layer architecture, isntead of a Dual-Stack implementation,w hich meant that the ipv6 TCP and UDP was grouped together and completely separate from ipv4.</p> <p>Interoperability is probably a key issue for anything being introduced. IPv6 was built-in for interoperability: ISATAP, 6to4, 6over4, Teredo, portProxy. Teredo is very important because it bootstraps the world from IPv6 to IPv4. However it is not without problems.</p> <p>That brings us to peer-to-peer networking. P2P goal is to enable direct communication between applications without relying on centralized&nbsp; servers.&nbsp; You could keep commnciating with everyone by keeping connections opened. You need to prevent DoS, Secure with crypto, resolve changin addresses, maintain dynamically changing group of nodes, and communicate with a subnet.</p> <p>The p2p in vista is based in IPv6. It's installed by default in Windows Vista. At heart you have low-level and high level APIs.</p> <p>The concept of a cloud is a group of peers that can communciate with each others. There's a global cloud with everybody, and a link local cloud, or several private global clouds.</p> <p>A peer is a machine runnnign the application that connects to other. It has a Name and a PNRP ID, and a Certified Peer Address.</p> <p>[EDIT: This is overall a big presentation about clouds, chrod based networks, graphs, etc. I worked for too many years with gnutella / gpulp / jxta to contiue blogging about the presentation. Battery is nearly dead anyway.]</p> <div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:d7f10564-9917-443b-86b9-d5ee27fe4388" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a href="http://technorati.com/tags/TechEd-Developers" rel="tag">TechEd-Developers</a>, <a href="http://technorati.com/tags/TechEd" rel="tag">TechEd</a></div> 